//==============================================================================
//
//	SINJISOFT GAME
//
//	FILE NAME
//		Raccoon2.cpp
//
//	DESCRIPTION
//		아기 너구리의 모험 게임 
//
//	REFERENCES
//		SINJISOFT Game Porting Guide
//
//	Copyright (C) 2001 by SINJISOFT. All Rights Reserved.
//
//==============================================================================

#include <stdio.h>

#include <string.h>

#include <stdlib.h>

#include "..\GLib\GLib.h"

#ifdef SKTT5

#define h3Xp5zzX 1000 

#define CY8MH6Zm 750 

#define wZUVkeyM 50

#define pLHAO6wY 10

#define bq7hBuJp 100

#define m636silQ 30

#define b0t8g7RW 0 

#define zLvtYsYS 1

#define s2hbwcOz 2

#define Axhx2zms 3

#define ojG4fmSf 4

#define mkSSdPlt 5

#define YjtX86Ae 6

#define vDRVyIRp 200 

#define M8UBHF35 215 

#define LHapvykR 230 

#define LEAWYdEl 250 

#define b2qye5p8 2

#define M2C6gQxY 30

#define ctK3p0nN 90

#define Fj5YF9i1 10

#define MJCF06QJ 0

#define mpKkbil8 1

#define Ly2N9FFg 2

#define WOpO548C 3

#define m6xtogf5 4

#define ftfjUT53 48 

#define whFcpWZ2 1 

#define QsIeLzu2 5 

#define MvJxjYE1 7

#define ycn2zAIX 4 

#define q5xbFf2b 16 

#define dLoBAaYF 11

#define IkAscWZj 25

#define fsKaHoge 0 

#define diqfv0Bt 1 

#define tHPaovGf 2 

#define QhKc1OCM 3 

#define JKwvDglH 4 

#define vZBFkLJU 5 

#define ae3IgZLM 6 

#define fzMn4i1y 7 

#define oMcmIwG9 8 

#define gA4tyZ6E 9 

#define FZKfkqQn 10 

#define FI9zND1m 11 

#define DBIqOZlz 12 

#define pKmgEMCB 13 

#define EYEKPgoo 14 

#define B6WhiIG9 15 

#define QDxquDF9 16 

#define Eu0ZPKYf 17 

#define xVu67rAS 18 

#define FpGshuj6 19 

#define i1bsvscO 255 

#include "ma2Raccoon3.cpp" 

#include "mapRaccoon3.cpp" 

#ifdef GET_RUNBACK

#include "runback0.cpp" 

#include "runback1.cpp" 

#include "runback2.cpp"
static const BYTE *const DH5Al86q[] = {  mv3HKwnz, s9s3EqZz, pnaE7zL9
}; 
#else
static const BYTE mv3HKwnz[]= { 
#include "back0.def" 
}; static const BYTE s9s3EqZz[]= { 
#include "back1.def" 
}; static const BYTE pnaE7zL9[]= { 
#include "back2.def" 
}; static const BYTE * const DH5Al86q[] = { 
mv3HKwnz, s9s3EqZz, pnaE7zL9 }; 
#endif
static const BYTE *const MxaYFKf4[] = {
WbqASfMz, 
PxkoDZ96, 
jVoCmQ2v, 
t3qQyepx, 
H0QenOlc, 
e742jxUb, 
HKkK9xUT, 
WP78CCsI, 
GOwPxhpA, 
pAIjdDJn, 
ZVDbKBq7, 
pEmKH0us, 
ZnNyaqYW, 
A9xQ4Vh6 
};
static const BYTE *const Va3mQ9uY[] = {
t4qzaYHw, 
mmqiZxi7, jPVrKFZz, uwVq9OeB, t7fE8lgK, i2NrRJiB,
RoLcx5Rp, CCyNC48Y,  oCa3i5tg,  r23FchhA,
HTiKEkBK, zH7wUCjQ, S0wnz7JD, JK0JqFmQ, HWpGyAeb,
A4DyGYLk 
};
static const BYTE *const GFQUq938[] = {
H1G8XoEy, 
cXsO2ZWP, fVWtP902, nYHkffJe, UL1j91DY, ZKd4bSEe,
KBiBLRsS, zTQdDEMy,  n8sPwEQZ,  yB88FzrU,
YyRteHno, obd3rXH3, xRSAt1IX, Ae3zrUtq, NGBqi8R2,
Swn9p038 
};
static const BYTE *const B1Z4oC1s[] = {
ftCEkD17, 
nWPA53yF, cLOeH6w9, h6o3pSKP, XmNVTMo3, QwVKdrPF,
Q5Q5Bmyx, ovytSUIj,  uOO8pf8y,  y5pRMfWt,
Mb5wEGLS, jW2TJe0W, kvOoGM2L, tyDuJ5Gh, KpKzeCBq,
QJVyOYjJ 
};
static const BYTE *const h0QtRrTP[] = {
pnwJFKbB, 
Rbr6gDEr, YQukkjL9, R3RH5Q7p, lf5IR5XD, ywM99CGy,
c1yL3ueh, YSwtE97m,  kgMi2hpF,  c0w1iqSp,
kJEOdrgc, T1xwLLQj, eoOp1psH, zl55jV9Y, nzvpJwku,
MGDUO8x1 
};
static const BYTE *const QbiQL2UG[] = {
H1eVDWXU, 
EeRR3hHy, tHTO6ObW, FUvKrLFp, P0sDgg0A, Y1UuJ8mM,
QaKStTtt, V8c05IaJ,  v2vsJu6r,  ylaTlwTN,
KuARn8AE, OT9BvqUD, VFlB3af7, JgsVT4zY, HRpVpREK,
U9283A0P 
};
static const BYTE *const EErSHOay[] = {
BrgZyB0q, 
Ev4Ywk6S, h0BjWTZi, jHssE14F, rBx0CooU, joIosVQ1,
QsZBfaXf, xPfn7LCK, 
ulIgzpum, 
ukJoStXU, VGMutz5I, fNuXUKcl, mrguskuo, kpRdC5dM,
bkaqULUC, vXrprofN 
};
static const BYTE *const iEdEoThM[] = {
fg0dqUaW, 
QFNrv0Tq, DPIHNuyF, De0E9WQi, U2rUDUpu, hh5HXAET,
mMwLV1rB, XMOGpOB8, 
A1dIEVh0, 
bGMsIGoq, dnnFjvLq, Re9ECzJe, bBmaxmOt, aKpRMdUa,
uGMpB5bb, uGMpB5bb 
};
static g_Object kteUaJLB = { 0, 70, 0, 0, 0, 7, 18 };
static const int taBnpZpB[] = { 2, 2, 3, 3, 3, 3, 4, 4, 4, 4 };
static const int k6SGOaGi[] = { 5, 4, 3, 2, 2, 2, 2, 2, 2, 2 };
static const int JioUVFei[] = { 10, 20, 30, 40, 50, 60, 70, 80, 90, 100 };
static const int PzVwUAqY[] = { 10, 10, 20, 20, 20, 20, 30, 30, 30, 30 };
static const int nxgaojuM[MvJxjYE1] = { 3, 8, 12, 13, 12, 8, 3 };
static const int nlKCG2Kz[] =  { 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15 }; 
static const int QjAHRUJU[] =  { 16+26, 17+26, 18+26, 20+26, 22+26, 24+26, 26+26, 29+26, 32+26, 36+26, 40+26, 45+26, 51+26, 59+26, 65+26, 78+26 }; 
static const int RlC199Bc[FpGshuj6][q5xbFf2b] = {
{ 44, 44, 43, 43, 42, 41, 40, 39, 38, 36, 34, 32, 30, 27, 23, 19}, 
{ 44, 44, 43, 43, 42, 41, 40, 39, 38, 36, 34, 32, 30, 27, 23, 19}, 
{ 52, 52, 53, 54, 54, 55, 56, 57, 58, 60, 62, 64, 66, 69, 73, 77}, 
{ 52, 52, 53, 54, 54, 55, 56, 57, 58, 60, 62, 64, 66, 69, 73, 77}, 
{ 42, 41, 41, 40, 39, 38, 36, 34, 33, 30, 28, 25, 21, 16, 11, 5}, 
{ 42, 41, 41, 40, 39, 38, 36, 34, 33, 30, 28, 25, 21, 16, 11, 5}, 
{ 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48}, 
{ 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48}, 
{ 54, 55, 55, 57, 58, 59, 60, 62, 63, 66, 68, 71, 75, 80, 85, 91}, 
{ 54, 55, 55, 57, 58, 59, 60, 62, 63, 66, 68, 71, 75, 80, 85, 91}, 
{ 42, 41, 41, 40, 39, 38, 36, 34, 33, 30, 28, 25, 21, 16, 11, 5}, 
{ 46, 46, 46, 45, 45, 44, 44, 43, 43, 42, 41, 40, 39, 37, 35, 33}, 
{ 50, 50, 50, 51, 51, 52, 52, 53, 53, 54, 55, 56, 57, 59, 61, 63}, 
{ 54, 55, 55, 57, 58, 59, 60, 62, 63, 66, 68, 71, 75, 80, 85, 91}, 
{ 42, 41, 41, 40, 39, 38, 36, 34, 33, 30, 28, 25, 21, 16, 11, 5}, 
{ 46, 46, 46, 45, 45, 44, 44, 43, 43, 42, 41, 40, 39, 37, 35, 33}, 
{ 50, 50, 50, 51, 51, 52, 52, 53, 53, 54, 55, 56, 57, 59, 61, 63}, 
{ 54, 55, 55, 57, 58, 59, 60, 62, 63, 66, 68, 71, 75, 80, 85, 91}, 
{ 46, 46, 46, 45, 45, 44, 44, 43, 43, 42, 41, 40, 39, 37, 35, 33} 
}; static const int ZzCOV2sZ[FpGshuj6] = {
38, 
38, 
38, 
38, 
22, 
22, 
22, 
22, 
22, 
22, 
10, 
10, 
10, 
10, 
10, 
10, 
10, 
10, 
91 
};
static WORD iazoOS2M; 
static int J6vnDQgO; 
static int E1nAopVG; 
static int fvnlciAY; 
static int d2ePTkMd; 
static int AmUWMyZN; 
static int OzV4t8nh; 
static int VSwplCkH; 
static int DbZX9wum; 
static int KZVoRGqd; static int KTvMIh3o;
static int iQNweGXz; static int H4GBPGLg;
static int cujlqsJf; 
static int tl5dgrIq; 
static int ULS5bpov[ycn2zAIX]; static int DmxNSVmp[ycn2zAIX];
static int qKIpoOYy; static int q7YksxRB;
static int vHMCqW6t; 
#define IwDwVzm4(n, d, max) n = (n+(d) > (max)) ? (max) : n+(d)

#define zHQUd4IY(n, d, IExrkaR4) n = (n-(d) < (IExrkaR4)) ? (IExrkaR4) : n-(d)
void DrawReadyMark(int stageNum, int nX)
{ char A7FOZK6a[10]; if (s_Frame3) { mil_CopyImage((s_ImgBlock*)EdUiF2EC, nX, SWAP_LCD_HEIGHT/2-11);
if (stageNum != 0) { sprintf(A7FOZK6a, "STAGE %d", stageNum);
mil_DrawStringSolid(nX, SWAP_LCD_HEIGHT/2, 
A7FOZK6a, S_FONT_MEDIUM, S_BLACK, 0x04, S_CENTER);
} } } void gm_DrawPauseMark(void) { mil_CopyImage((s_ImgBlock*)gWofz8j2, SWAP_LCD_WIDTH/2, SWAP_LCD_HEIGHT/2);
} void gm_PlayStageChange(void) { gext_PlaySound((BYTE *)FI1tSDJH, sizeof(FI1tSDJH));
}
void DrawClearMark()
{ if (s_Frame3) { mil_CopyImage((s_ImgBlock*)MRaPnQQi, SWAP_LCD_WIDTH/2, SWAP_LCD_HEIGHT/2);
} } void DrawOverMark() { if (s_Frame3) {
mil_CopyImage((s_ImgBlock*)zTg0Afo5, SWAP_LCD_WIDTH/2, SWAP_LCD_HEIGHT/2);
} }
static void TaD7u5w4()
{ int year, month, day, hour, IExrkaR4, sec;
gext_GetDate(&year, &month, &day, &hour, &IExrkaR4, &sec);
gext_RandomSeed(sec); gext_PlaySound((BYTE *)vpqpiEdq, sizeof(vpqpiEdq));
J6vnDQgO = b0t8g7RW; 
E1nAopVG = 0; 
iazoOS2M = 0; 
d2ePTkMd = LEAWYdEl + Fj5YF9i1*13; 
KTvMIh3o = 0; iQNweGXz = 0; OzV4t8nh = -5;
VSwplCkH = (SWAP_LCD_HEIGHT - 30) >> 1; }
static void BxJ4Yue1()
{ int H0Ng1GoT; gext_PlaySound((BYTE *)zXZUmZNO, sizeof(zXZUmZNO));
fvnlciAY = h3Xp5zzX; 
J6vnDQgO = s2hbwcOz; 
d2ePTkMd = LEAWYdEl + Fj5YF9i1*13; 
AmUWMyZN = CY8MH6Zm; 
kteUaJLB.state = MJCF06QJ; 
kteUaJLB.x = ftfjUT53; kteUaJLB.y = 105+40;
kteUaJLB.dx = 0; H4GBPGLg = 0; cujlqsJf = 0;
tl5dgrIq = 0; for (H0Ng1GoT = 0; H0Ng1GoT < ycn2zAIX; H0Ng1GoT++)
ULS5bpov[H0Ng1GoT] = i1bsvscO; q7YksxRB = 0;
vHMCqW6t = 0; }
static void k6Bzul5a()
{ char A7FOZK6a[10];
mil_CopyImage((s_ImgBlock*)dPs7MDO4, SWAP_LCD_WIDTH/2, SWAP_LCD_HEIGHT/2);
sprintf(A7FOZK6a, "STAGE%2d", E1nAopVG + 1);
mil_DrawString(44, 3, A7FOZK6a, S_FONT_MEDIUM, S_BLACK, S_LEFT);
}
static void gAZOK88k()
{ int H0Ng1GoT; int Gap; if (kteUaJLB.state == WOpO548C) { 
KZVoRGqd++; return; } if (fvnlciAY < dLoBAaYF) { 
if (kteUaJLB.x < ftfjUT53 - 3) kteUaJLB.x += 3;
else if (kteUaJLB.x > ftfjUT53 + 3)
kteUaJLB.x -= 3; else kteUaJLB.x = ftfjUT53;
return; } if (kteUaJLB.state != MJCF06QJ)
return; if (kteUaJLB.dx > 0) { 
if (kteUaJLB.x < 87) { 
kteUaJLB.x += QsIeLzu2; kteUaJLB.dx--;
} else kteUaJLB.dx = 0; } else if (kteUaJLB.dx < 0) { 
if (kteUaJLB.x > 9) {
kteUaJLB.x -= QsIeLzu2; kteUaJLB.dx++;
} else kteUaJLB.dx = 0; } for (H0Ng1GoT = 0; H0Ng1GoT < ycn2zAIX; H0Ng1GoT++) 
{ if (ULS5bpov[H0Ng1GoT] != i1bsvscO && 
QjAHRUJU[DmxNSVmp[H0Ng1GoT]] + 35 < kteUaJLB.y && 
QjAHRUJU[DmxNSVmp[H0Ng1GoT]] + 35 > kteUaJLB.y - 10) 
{ Gap = kteUaJLB.x - RlC199Bc[ULS5bpov[H0Ng1GoT]][DmxNSVmp[H0Ng1GoT]];
if (Gap < 0) Gap = -Gap; if (ZzCOV2sZ[ULS5bpov[H0Ng1GoT]] > Gap && (ULS5bpov[H0Ng1GoT] == FZKfkqQn || ULS5bpov[H0Ng1GoT] == FI9zND1m || ULS5bpov[H0Ng1GoT] == DBIqOZlz || ULS5bpov[H0Ng1GoT] == pKmgEMCB)) 
{ 
gext_PlaySound((BYTE *)k1UnDdet, sizeof(k1UnDdet));
q7YksxRB = 0; vHMCqW6t = 0; iazoOS2M += 10;
ULS5bpov[H0Ng1GoT] = i1bsvscO; tl5dgrIq--;
IwDwVzm4(AmUWMyZN, wZUVkeyM, CY8MH6Zm); zHQUd4IY(d2ePTkMd, M2C6gQxY, vDRVyIRp);
} else if (ZzCOV2sZ[ULS5bpov[H0Ng1GoT]] > Gap && (ULS5bpov[H0Ng1GoT] == EYEKPgoo || ULS5bpov[H0Ng1GoT] == B6WhiIG9 || ULS5bpov[H0Ng1GoT] == QDxquDF9 || ULS5bpov[H0Ng1GoT] == Eu0ZPKYf)) { 
gext_PlaySound((BYTE *)T7XES8DV, sizeof(T7XES8DV));
q7YksxRB = 0; vHMCqW6t = 0; ULS5bpov[H0Ng1GoT] = i1bsvscO;
tl5dgrIq--; zHQUd4IY(AmUWMyZN, m636silQ, 0);
zHQUd4IY(d2ePTkMd, M2C6gQxY, vDRVyIRp); }
break; } } for (H0Ng1GoT = 0; H0Ng1GoT < ycn2zAIX; H0Ng1GoT++) 
{ if (ULS5bpov[H0Ng1GoT] != i1bsvscO &&  QjAHRUJU[DmxNSVmp[H0Ng1GoT]] + 35 < kteUaJLB.y 
&& QjAHRUJU[DmxNSVmp[H0Ng1GoT]] + 35 > kteUaJLB.y - 10) 
{ Gap = kteUaJLB.x - RlC199Bc[ULS5bpov[H0Ng1GoT]][DmxNSVmp[H0Ng1GoT]];
if (Gap < 0) Gap = -Gap; if (ZzCOV2sZ[ULS5bpov[H0Ng1GoT]] > Gap && 
ULS5bpov[H0Ng1GoT] != FZKfkqQn && ULS5bpov[H0Ng1GoT] != FI9zND1m && ULS5bpov[H0Ng1GoT] != DBIqOZlz && ULS5bpov[H0Ng1GoT] != pKmgEMCB && 
ULS5bpov[H0Ng1GoT] != EYEKPgoo && ULS5bpov[H0Ng1GoT] != B6WhiIG9 && ULS5bpov[H0Ng1GoT] != QDxquDF9 && ULS5bpov[H0Ng1GoT] != Eu0ZPKYf) 
{ gext_PlaySound((BYTE *)KhsaPif4, sizeof(KhsaPif4));
q7YksxRB = 0; vHMCqW6t = 0; gext_StartVib(1);
kteUaJLB.state = Ly2N9FFg;  DbZX9wum = MvJxjYE1;
zHQUd4IY(AmUWMyZN, bq7hBuJp, 0); d2ePTkMd = LEAWYdEl;
IwDwVzm4(d2ePTkMd, ctK3p0nN, LEAWYdEl); break;
} } } }
static void LYXXB0V3()
{ int H0Ng1GoT; if (fvnlciAY == dLoBAaYF) {
for (H0Ng1GoT = 0; H0Ng1GoT < ycn2zAIX; H0Ng1GoT++) {
if (ULS5bpov[H0Ng1GoT] == i1bsvscO) { tl5dgrIq++;
ULS5bpov[H0Ng1GoT] = xVu67rAS; DmxNSVmp[H0Ng1GoT] = 0;
break; } } } if (cujlqsJf > 0) cujlqsJf--;
else if (fvnlciAY > IkAscWZj &&
tl5dgrIq < taBnpZpB[E1nAopVG] &&  RANDOM(JioUVFei[E1nAopVG])) 
{ for (H0Ng1GoT = 0; H0Ng1GoT < ycn2zAIX; H0Ng1GoT++) {
if (ULS5bpov[H0Ng1GoT] == i1bsvscO) { cujlqsJf = k6SGOaGi[E1nAopVG];
tl5dgrIq++; if (H4GBPGLg == 1) { 
H4GBPGLg = 0; ULS5bpov[H0Ng1GoT] = FZKfkqQn + gext_Random(0, 3);
} else ULS5bpov[H0Ng1GoT] = gext_Random(0, FpGshuj6 - 2);
DmxNSVmp[H0Ng1GoT] = 0; break; } } } if (!(kteUaJLB.state == Ly2N9FFg && DbZX9wum > 2)) {
for (H0Ng1GoT = 0; H0Ng1GoT < ycn2zAIX; H0Ng1GoT++) {
if (ULS5bpov[H0Ng1GoT] != i1bsvscO) { DmxNSVmp[H0Ng1GoT]++; 
if (DmxNSVmp[H0Ng1GoT] == q5xbFf2b) { 
ULS5bpov[H0Ng1GoT] = i1bsvscO; tl5dgrIq--;
} } } } }
static void vmYjoFEu()
{ BYTE* pTrap; int H0Ng1GoT; char A7FOZK6a[15];
if ((J6vnDQgO == Axhx2zms || J6vnDQgO == ojG4fmSf) && kteUaJLB.state != Ly2N9FFg) {
fvnlciAY--; if (fvnlciAY > 0 && (fvnlciAY%10) == 0) {
if (d2ePTkMd < M8UBHF35) iazoOS2M += 5; else if (d2ePTkMd < LHapvykR)
iazoOS2M += 4; else iazoOS2M += 3; if ((fvnlciAY%100) == 0) 
H4GBPGLg = 1; } } if (AmUWMyZN > 0) AmUWMyZN--;
zHQUd4IY(d2ePTkMd, b2qye5p8, vDRVyIRp); 
#ifdef GET_RUNBACK
if (kteUaJLB.state==mpKkbil8 || kteUaJLB.state==MJCF06QJ) mil_CopyImage((s_ImgBlock*)DH5Al86q[s_Frame3],0, 0);
else mil_CopyImage((s_ImgBlock*)DH5Al86q[1], 0, 0);
FILE *fp0, *fp1, *fp2; if(qKIpoOYy==0) { if(s_Frame3==0) {
if((fp0=fopen("C:\\My Projects\\Sinjisoft\\PROJECT\\GEmul22\\GameSrc\\G81 Raccoon3\\back0.def","wt"))==NULL){
exit(0); } else  { for(H0Ng1GoT=0;H0Ng1GoT<128*160;H0Ng1GoT++)
{ fprintf(fp0,"0x%02x,",swLcdBuffer[H0Ng1GoT]);
if(H0Ng1GoT%16==0 && H0Ng1GoT>8) fprintf(fp0,"\n");
} } } if(s_Frame3==1) { if((fp0=fopen("C:\\My Projects\\Sinjisoft\\PROJECT\\GEmul22\\GameSrc\\G81 Raccoon3\\back1.def","wt"))==NULL){
exit(0); } else  { for(H0Ng1GoT=0;H0Ng1GoT<128*160;H0Ng1GoT++)
{ fprintf(fp0,"0x%02x,",swLcdBuffer[H0Ng1GoT]);
if(H0Ng1GoT%16==0 && H0Ng1GoT>8) fprintf(fp0,"\n");
} } } if(s_Frame3==2) { if((fp0=fopen("C:\\My Projects\\Sinjisoft\\PROJECT\\GEmul22\\GameSrc\\G81 Raccoon3\\back2.def","wt"))==NULL){
exit(0); } else  { for(H0Ng1GoT=0;H0Ng1GoT<128*160;H0Ng1GoT++)
{ fprintf(fp0,"0x%02x,",swLcdBuffer[H0Ng1GoT]);
if(H0Ng1GoT%16==0 && H0Ng1GoT>8) fprintf(fp0,"\n");
} } } }  if(qKIpoOYy==1) { if(s_Frame3==0) {
if((fp1=fopen("C:\\My Projects\\Sinjisoft\\PROJECT\\GEmul22\\GameSrc\\G81 Raccoon3\\back0.def","wt"))==NULL){
exit(0); } else  { for(H0Ng1GoT=0;H0Ng1GoT<128*160;H0Ng1GoT++)
{ fprintf(fp1,"0x%02x,",swLcdBuffer[H0Ng1GoT]);
if(H0Ng1GoT%16==0 && H0Ng1GoT>8) fprintf(fp1,"\n");
} } } if(s_Frame3==1) { if((fp1=fopen("C:\\My Projects\\Sinjisoft\\PROJECT\\GEmul22\\GameSrc\\G81 Raccoon3\\back1.def","wt"))==NULL){
exit(0); } else  { for(H0Ng1GoT=0;H0Ng1GoT<128*160;H0Ng1GoT++)
{ fprintf(fp1,"0x%02x,",swLcdBuffer[H0Ng1GoT]);
if(H0Ng1GoT%16==0 && H0Ng1GoT>8) fprintf(fp1,"\n");
} } } if(s_Frame3==2) { if((fp1=fopen("C:\\My Projects\\Sinjisoft\\PROJECT\\GEmul22\\GameSrc\\G81 Raccoon3\\back2.def","wt"))==NULL){
exit(0); } else  { for(H0Ng1GoT=0;H0Ng1GoT<128*160;H0Ng1GoT++)
{ fprintf(fp1,"0x%02x,",swLcdBuffer[H0Ng1GoT]);
if(H0Ng1GoT%16==0 && H0Ng1GoT>8) fprintf(fp1,"\n");
} } } }  if(qKIpoOYy==2) { if(s_Frame3==0) {
if((fp2=fopen("C:\\My Projects\\Sinjisoft\\PROJECT\\GEmul22\\GameSrc\\G81 Raccoon3\\back0.def","wt"))==NULL){
exit(0); } else  { for(H0Ng1GoT=0;H0Ng1GoT<128*160;H0Ng1GoT++)
{ fprintf(fp2,"0x%02x,",swLcdBuffer[H0Ng1GoT]);
if(H0Ng1GoT%16==0 && H0Ng1GoT>8) fprintf(fp2,"\n");
} } } if(s_Frame3==1) { if((fp2=fopen("C:\\My Projects\\Sinjisoft\\PROJECT\\GEmul22\\GameSrc\\G81 Raccoon3\\back1.def","wt"))==NULL){
exit(0); } else  { for(H0Ng1GoT=0;H0Ng1GoT<128*160;H0Ng1GoT++)
{ fprintf(fp2,"0x%02x,",swLcdBuffer[H0Ng1GoT]);
if(H0Ng1GoT%16==0 && H0Ng1GoT>8) fprintf(fp2,"\n");
} } } if(s_Frame3==2) { if((fp2=fopen("C:\\My Projects\\Sinjisoft\\PROJECT\\GEmul22\\GameSrc\\G81 Raccoon3\\back2.def","wt"))==NULL){
exit(0); } else  { for(H0Ng1GoT=0;H0Ng1GoT<128*160;H0Ng1GoT++)
{ fprintf(fp2,"0x%02x,",swLcdBuffer[H0Ng1GoT]);
if(H0Ng1GoT%16==0 && H0Ng1GoT>8) fprintf(fp2,"\n");
} } } }  qKIpoOYy ++; 
#else 
if (kteUaJLB.state==mpKkbil8 || kteUaJLB.state==MJCF06QJ) memcpy(swLcdBuffer, DH5Al86q[s_Frame3], sizeof(mv3HKwnz));
else memcpy(swLcdBuffer, DH5Al86q[1], sizeof(mv3HKwnz));

#endif
for (H0Ng1GoT = 0; H0Ng1GoT < ycn2zAIX; H0Ng1GoT++) {
if (ULS5bpov[H0Ng1GoT] != i1bsvscO) { switch (ULS5bpov[H0Ng1GoT]) {
case fsKaHoge: case tHPaovGf: pTrap = (BYTE *)Va3mQ9uY[nlKCG2Kz[DmxNSVmp[H0Ng1GoT]]];
break; case JKwvDglH: case ae3IgZLM: case oMcmIwG9:
pTrap = (BYTE *)GFQUq938[nlKCG2Kz[DmxNSVmp[H0Ng1GoT]]];
break; case diqfv0Bt: case QhKc1OCM: pTrap = (BYTE *)B1Z4oC1s[nlKCG2Kz[DmxNSVmp[H0Ng1GoT]]];
break; case vZBFkLJU: case fzMn4i1y: case gA4tyZ6E:
pTrap = (BYTE *)h0QtRrTP[nlKCG2Kz[DmxNSVmp[H0Ng1GoT]]];
break; case FZKfkqQn: case FI9zND1m: case DBIqOZlz:
case pKmgEMCB: pTrap = (BYTE *)QbiQL2UG[nlKCG2Kz[DmxNSVmp[H0Ng1GoT]]];
break; case EYEKPgoo: case B6WhiIG9: case QDxquDF9:
case Eu0ZPKYf: pTrap = (BYTE *)EErSHOay[nlKCG2Kz[DmxNSVmp[H0Ng1GoT]]];
break; case xVu67rAS: pTrap = (BYTE *)iEdEoThM[nlKCG2Kz[DmxNSVmp[H0Ng1GoT]]];
break; } mil_CopyImage(pTrap, RlC199Bc[ULS5bpov[H0Ng1GoT]][DmxNSVmp[H0Ng1GoT]], QjAHRUJU[DmxNSVmp[H0Ng1GoT]] + 35);
} } if (J6vnDQgO == s2hbwcOz && (s_Frame3))
DrawReadyMark(E1nAopVG + 1, SWAP_LCD_WIDTH/2-10);

#define KyR9nCSC 28
sprintf(A7FOZK6a, "%3d", E1nAopVG + 1);
mil_DrawString(SWAP_LCD_WIDTH-29, VSwplCkH +2 , A7FOZK6a, S_FONT_MEDIUM, S_BLACK, S_LEFT);
sprintf(A7FOZK6a, "%03d", iazoOS2M/10);
mil_DrawString(SWAP_LCD_WIDTH-23, VSwplCkH + 30, A7FOZK6a, S_FONT_MEDIUM, S_BLACK, S_LEFT);
if (fvnlciAY > 0)
iQNweGXz = KyR9nCSC - (KyR9nCSC*fvnlciAY/h3Xp5zzX)-1;
else iQNweGXz = KyR9nCSC; KTvMIh3o = KyR9nCSC;
mil_CopyImage((s_ImgBlock*)HIfiuyww, SWAP_LCD_WIDTH-25, VSwplCkH + 58);
mil_SetColor(S_BLACK); mil_FillRect(SWAP_LCD_WIDTH-25, VSwplCkH + 58, SWAP_LCD_WIDTH-25 + iQNweGXz, VSwplCkH + 58 + 3); 
mil_CopyImage((s_ImgBlock*)HIfiuyww, SWAP_LCD_WIDTH-23, VSwplCkH + 82);
if (AmUWMyZN > (CY8MH6Zm >> 2) || (s_Frame2)) {
iQNweGXz = KyR9nCSC*AmUWMyZN/CY8MH6Zm; mil_SetColor(0x1A);
mil_FillRect(SWAP_LCD_WIDTH-27, VSwplCkH + 82, SWAP_LCD_WIDTH-27 + iQNweGXz, VSwplCkH + 82 + 3); 
} }
static void gviRJenu()
{
switch (kteUaJLB.state) {
case MJCF06QJ: mil_CopyImage((s_ImgBlock*)MxaYFKf4[s_Frame2],
kteUaJLB.x, kteUaJLB.y); break; case mpKkbil8:
if (KZVoRGqd) { mil_CopyImage((s_ImgBlock*)MxaYFKf4[2 + s_Frame3],
kteUaJLB.x, kteUaJLB.y - nxgaojuM[DbZX9wum - 1]);
} else { mil_CopyImage((s_ImgBlock*)MxaYFKf4[5 + s_Frame3],
kteUaJLB.x, kteUaJLB.y - nxgaojuM[DbZX9wum - 1]);
} if (--DbZX9wum == 0) kteUaJLB.state = MJCF06QJ;
break; case Ly2N9FFg: mil_CopyImage((s_ImgBlock*)MxaYFKf4[8 + s_Frame2],
kteUaJLB.x, kteUaJLB.y); if (--DbZX9wum == 0)
kteUaJLB.state = MJCF06QJ; break; case WOpO548C:
mil_CopyImage((s_ImgBlock*)MxaYFKf4[10 + s_Frame2],
kteUaJLB.x,  kteUaJLB.y); break; case m6xtogf5:
mil_CopyImage((s_ImgBlock*)MxaYFKf4[12 + s_Frame2],
kteUaJLB.x,  kteUaJLB.y); break; }
}
static void ZzZgAgiF(int ShowMode)
{ if (ShowMode != 0) 
{ mil_Clear(0x8A); mil_CopyImage((s_ImgBlock*)KoKXa1Ys, SWAP_LCD_WIDTH/2, SWAP_LCD_HEIGHT/2+10);
mil_CopyImage((s_ImgBlock*)HfPhKqsy, 7, 25);
}
else 
{ mil_Clear(S_WHITE);
mil_CopyImage((s_ImgBlock*)HfPhKqsy, 7, 25);
}
}
int Raccoon3Main(int nReason, int nData)
{ switch (nReason)  { case GLIB_MENU: 
ZzZgAgiF(0);
break; case GLIB_START:
TaD7u5w4();
g_StartTimer(0, d2ePTkMd, 1);
break;  case GLIB_TIMEOUT: switch (J6vnDQgO) 
{ case b0t8g7RW: k6Bzul5a(); break; case s2hbwcOz:
if (d2ePTkMd > LEAWYdEl) d2ePTkMd -= Fj5YF9i1;
else { J6vnDQgO = Axhx2zms; qKIpoOYy = 0;
} vmYjoFEu(); gviRJenu(); break; case Axhx2zms:
if (q7YksxRB == 0 && vHMCqW6t > 10) { q7YksxRB = 1;
gext_PlaySound_background((BYTE *)zXo9ZK7L, sizeof(zXo9ZK7L));
} else { vHMCqW6t++; } LYXXB0V3(); vmYjoFEu();
gAZOK88k(); gviRJenu(); if (AmUWMyZN <= 0) { 
gext_PlaySound((BYTE *)dR639vZE, sizeof(dR639vZE));
kteUaJLB.state = WOpO548C; d2ePTkMd = LEAWYdEl;
J6vnDQgO = mkSSdPlt; KZVoRGqd = 0; } else if (fvnlciAY == 0) { 
gext_PlaySound((BYTE *)dDKNvRKb, sizeof(dDKNvRKb));
kteUaJLB.state = m6xtogf5; d2ePTkMd = LEAWYdEl;
J6vnDQgO = ojG4fmSf; } break; case mkSSdPlt:
gAZOK88k(); vmYjoFEu(); gviRJenu(); if (KZVoRGqd > 10) 
J6vnDQgO = YjtX86Ae; break; case ojG4fmSf:
gAZOK88k(); vmYjoFEu(); gviRJenu(); if (fvnlciAY == -15) { 
E1nAopVG++; if(E1nAopVG>=9) E1nAopVG=9; KTvMIh3o = 0;
iQNweGXz = 0; BxJ4Yue1(); J6vnDQgO = s2hbwcOz;
} break; case YjtX86Ae: { mil_Clear(0x8B);
ZzZgAgiF(1);  return g_CheckScore(iazoOS2M/10);
} } gext_DrawLcd((char*)swLcdBuffer);
g_StartTimer(0, d2ePTkMd, 1);
break; case GLIB_KEYPRESS: switch (J6vnDQgO) 
{ case b0t8g7RW: switch (nData) {
case GLIB_KEY_DOWN: 
E1nAopVG = (E1nAopVG + 9)%10; gm_PlayStageChange();
break;
case GLIB_KEY_UP: 
E1nAopVG = (E1nAopVG + 1)%10; gm_PlayStageChange();
break; case GLIB_KEY_1: E1nAopVG = 0; gm_PlayStageChange(); break;
case GLIB_KEY_2: E1nAopVG = 1; gm_PlayStageChange(); break;
case GLIB_KEY_3: E1nAopVG = 2; gm_PlayStageChange(); break;
case GLIB_KEY_4: E1nAopVG = 3; gm_PlayStageChange(); break;
case GLIB_KEY_5: E1nAopVG = 4; gm_PlayStageChange(); break;
case GLIB_KEY_6: E1nAopVG = 5; gm_PlayStageChange(); break;
case GLIB_KEY_7: E1nAopVG = 6; gm_PlayStageChange(); break;
case GLIB_KEY_8: E1nAopVG = 7; gm_PlayStageChange(); break;
case GLIB_KEY_9: E1nAopVG = 8; gm_PlayStageChange(); break;
case GLIB_KEY_0: E1nAopVG = 9; gm_PlayStageChange(); break;
case GLIB_KEY_OK:  J6vnDQgO = s2hbwcOz; BxJ4Yue1();
break; } break; case s2hbwcOz: J6vnDQgO = Axhx2zms;
d2ePTkMd = LEAWYdEl; break; case Axhx2zms:
if (kteUaJLB.state != MJCF06QJ) break; if (nData == GLIB_KEY_LEFT || nData == GLIB_KEY_4)
kteUaJLB.dx -= whFcpWZ2; else if (nData == GLIB_KEY_RIGHT || nData == GLIB_KEY_6)
kteUaJLB.dx += whFcpWZ2; else if (nData == GLIB_KEY_OK || nData == GLIB_KEY_5) 
{ gext_PlaySound((BYTE *)FI1tSDJH, sizeof(FI1tSDJH));
q7YksxRB = 0; vHMCqW6t = 0; DbZX9wum = MvJxjYE1;
kteUaJLB.state = mpKkbil8; if (RANDOM(50))
{ KZVoRGqd = 0; } else { KZVoRGqd = 1; } zHQUd4IY(AmUWMyZN, pLHAO6wY, 0);
} break; } break; case GLIB_PAUSE:
gm_DrawPauseMark();
q7YksxRB = 0; gext_DrawLcd((char*)swLcdBuffer);
return GRET_PAUSE; case GLIB_CONTINUE:
if(J6vnDQgO==b0t8g7RW) gext_PlaySound((BYTE *)vpqpiEdq, sizeof(vpqpiEdq));
g_StartTimer(0, d2ePTkMd, 1); break; case GLIB_END:
mil_SaveLCD(); return GRET_PAUSE; case GLIB_MENU_SCORE:
case GLIB_SCORE: mil_Clear(0x8B); ZzZgAgiF(1); 
break; case GLIB_HELP: case GLIB_HELP_TIMEOUT:
mil_CopyImage((s_ImgBlock*)tDwPyRCh, SWAP_LCD_WIDTH/2, SWAP_LCD_HEIGHT/2);
break; } return GRET_NORMAL; } 
#endif 
